@model IndexViewModel    
@{
    ViewData["Title"] = "Home";
    bool hasCheckOutToday = ViewBag.HasCheckOutToday ?? false;
}



<section class="bg-light">

	@if (hasCheckOutToday)
	{
        <div class="container mt-3 position-sticky" style="top: 0; z-index: 1030;">
			<div class="alert alert-warning alert-dismissible fade show" role="alert">
				<strong>Checkout Reminder!</strong> Checkout for booking @Model.CurrentBooking.Id is scheduled for today at @Model.CurrentBooking.ApartmentViewModel.Name.
                <form asp-controller="CheckOut" asp-action="CheckoutReminder" method="post" class="d-inline">
					<a asp-controller="CheckOut" asp-action="CheckOutForm" type="submit" name="action" value="checkout" class="btn btn-danger btn-sm ms-2">
						Checkout Now
					</a>
					<button type="submit" name="action" value="dismiss" class="btn-close" aria-label="Close"></button>
					<p>Number of checkout today : @Model.NumberOfCheckout</p>
				</form>
			</div>
		</div>
	}
    
	<div class="container py-5">
		<div class="row">
			<div class="col-lg-7">
				<h1 class="display-4 fw-bold mb-4">Hello <span id="userName">@Model.UserViewModel.FirstName</span>, welcome to<br>Sun & escape apartment.</h1>
				<p class="lead mb-5">Experience luxury and comfort in the beautiful island of Aruba.</p>
				<div class="d-flex gap-3">
					<a asp-controller="Apartment" asp-action="ShowApartmentList" class="btn btn-dark px-4 py-2">View Apartments</a>
					<a asp-controller="Home" asp-action="Chat" class="btn btn-outline-dark px-4 py-2">Contact Us</a>
				</div>
			</div>
		</div>
	</div>
	<div class="wave-shape">
		<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
			<path fill="#12123e" fill-opacity="1" d="M0,96L80,117.3C160,139,320,181,480,186.7C640,192,800,160,960,154.7C1120,149,1280,171,1360,181.3L1440,192L1440,320L1360,320C1280,320,1120,320,960,320C800,320,640,320,480,320C320,320,160,320,80,320L0,320Z"></path>
		</svg>
	</div>
</section>
<section class="bg-primary-custom py-5">
    <div class="container">
        <div id="carouselExampleAutoplaying" class="carousel slide carousel-rounded shadow" data-bs-ride="carousel">
            <div class="carousel-indicators">
                <button type="button" data-bs-target="#carouselExampleAutoplaying" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                <button type="button" data-bs-target="#carouselExampleAutoplaying" data-bs-slide-to="1" aria-label="Slide 2"></button>
                <button type="button" data-bs-target="#carouselExampleAutoplaying" data-bs-slide-to="2" aria-label="Slide 3"></button>
            </div>
            <div class="carousel-inner rounded-4">
                <div class="carousel-item active">
                    <img src="~/IMG/apartment.jpg" class="d-block w-100" alt="Apartment view" style="height: 650px; object-fit: cover;">
                </div>
                <div class="carousel-item">
                    <img src="~/IMG/bedView.jpg" class="d-block w-100" alt="Bedroom view" style="height: 650px; object-fit: cover;">
                </div>
                <div class="carousel-item">
                    <img src="~/IMG/apartment.jpg" class="d-block w-100" alt="Apartment exterior" style="height: 650px; object-fit: cover;">
                </div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleAutoplaying" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleAutoplaying" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
    </div>
</section>
<section class="py-5 bg-light">
    <div class="container py-4">
        <h2 class="display-5 text-center mb-5">About us</h2>
        <div class="row align-items-center">
            <div class="col-lg-6">
                <p class="lead">
                    Our apartments are designed to offer you the sense
                    of comfort that you love to feel at your home.
                    We offer fully equipped apartments in the
                    neighborhood of papaya in Aruba.
                </p>
                <p class="lead">
                    Be it for leisure or for business, we offer you a
                    constant advise and recommendations to enhance
                    your stay and enjoy the beautiful island.
                </p>
                <p class="lead">
                    With their cozy ambiance, tasteful decoration, our
                    apartments and modern swimming pool will be one
                    of your favorite stops in Aruba.
                </p>
            </div>
            <div class="col-lg-6">
                <img src="~/IMG/map.jpg" alt="Location Map" class="img-fluid rounded shadow-sm">
            </div>
        </div>
    </div>
</section>
<section class="py-5">
    <div class="container py-4">
        <div class="row g-4">
            <div class="col-12 col-md-6">
                <div class="p-4 bg-light rounded">
                    <h2 class="display-5 mb-4">Our Apartment</h2>
                </div>
                <div class="mt-4">
                    <img src="~/IMG/bedroom.jpg" class="img-fluid rounded shadow" alt="Bedroom view">
                </div>
            </div>
            <div class="col-12 col-md-6 d-flex flex-column">
                <div class="mb-4">
                    <img src="~/IMG/bedroom-side.jpg" class="img-fluid rounded shadow" alt="Bedroom side view">
                </div>
                <div class="mt-auto">
                    <p class="lead">
                        The apartment is bright and inviting, featuring a palm-lined private pool, cozy seating area, and soft, neutral
                        tones throughout. Stay cool with the in-room A/C, and wind down comfortably in the queen-size bed after a day
                        spent soaking in the warm island sun.
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>
<section class="py-5 bg-light">
	<div class="container py-4">
		<h2 class="display-5 text-center mb-5">Our Amenities & Facilities</h2>
		<div class="row g-4">
			<div class="col-6 col-md-3">
				<div class="bg-white p-4 text-center rounded shadow-sm h-100">
					<i class="fas fa-swimming-pool fs-1 mb-3" style="color: #12123e;"></i>
					<h5>Swimming Pool</h5>
				</div>
			</div>
			<div class="col-6 col-md-3">
				<div class="bg-white p-4 text-center rounded shadow-sm h-100">
					<i class="fas fa-wifi fs-1 mb-3" style="color: #12123e;"></i>
					<h5>Wifi</h5>
				</div>
			</div>
			<div class="col-6 col-md-3">
				<div class="bg-white p-4 text-center rounded shadow-sm h-100">
					<i class="fas fa-washing-machine fs-1 mb-3" style="color: #12123e;"></i>
					<h5>Laundry</h5>
				</div>
			</div>
			<div class="col-6 col-md-3">
				<div class="bg-white p-4 text-center rounded shadow-sm h-100">
					<i class="fas fa-parking fs-1 mb-3" style="color: #12123e;"></i>
					<h5>Parking space</h5>
				</div>
			</div>
		</div>
	</div>
</section>
<!--all reviews section-->
<section class="py-5" style="background-color: #f7f2eb;">
    <div class="container py-4">
	    <h2 class="display-5 text-center mb-5">Hear from Our Guests</h2>
		<div id="reviewCards" class="row">
		    @foreach (var review in Model.ReviewViewModel)
		    {
			    <div class="col-md-6 mb-4">
				    <div class="bg-white p-4 rounded shadow-sm h-100">
					    <div class="d-flex justify-content-between align-items-center mb-3">
						    <span>@review.CreatedAt</span>
						    <div class="text-warning">
							    <i class="fas fa-star"></i>
							    <i class="fas fa-star"></i>
							    <i class="fas fa-star"></i>
							    <i class="fas fa-star"></i>
							    <i class="fas fa-star-half-alt"></i>
						    </div>
					    </div>
					    <p>
						   @review.Comments
					    </p>
				    </div>
			    </div>
		    }
	    </div>
	    <div class="d-flex justify-content-center mt-4">
		    <button id="prevBtn" class="btn btn-sm btn-dark mx-2">
			    <i class="fas fa-chevron-left"></i>
		    </button>
		    <button id="nextBtn" class="btn btn-sm btn-dark mx-2">
			    <i class="fas fa-chevron-right"></i>
		    </button>
	    </div>

    </div>
</section>

<button type="button" id="showCheckOutModalButton" class="d-none" data-bs-toggle="modal" data-bs-target="#checkOutModal">
	Show Checkout
</button>

<div class="modal fade" id="checkOutModal" tabindex="-1" aria-labelledby="checkOutModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="checkOutModalLabel">Checkout is Required</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<p>Please complete the checkout.</p>
			</div>
			<div class="modal-footer">
				<a asp-controller="CheckOut" asp-action="CheckOutForm" class="btn btn-primary">Proceed to Checkout</a>
				<a asp-controller="Home" asp-action="Index" class="btn btn-secondary">Cancel</a>
			</div>
		</div>
	</div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        @if (ViewBag.ShowCheckOutModal == true)
        {
	        <text>
            document.getElementById('showCheckOutModalButton').click();
            </text>
        }
    });


	/* --- pager for review cards ---------------------------------- */
	document.addEventListener('DOMContentLoaded', () => {

		const pageSize = 2;                             //
		const cards    = [...document.querySelectorAll('#reviewCards > .col-md-6')];
		const pages    = Math.ceil(cards.length / pageSize);
		let   page     = 0;                             // 0-based index

		const render = () => {
			cards.forEach((card, i) => {
				card.classList.toggle('d-none', Math.floor(i / pageSize) !== page);
			});
		};
		render();                                       // show first page

		document.getElementById('nextBtn').addEventListener('click', () => {
			page = (page + 1) % pages;                  // loop forward
			render();
		});
		document.getElementById('prevBtn').addEventListener('click', () => {
			page = (page - 1 + pages) % pages;          // loop backward
			render();
		});
	});

</script>